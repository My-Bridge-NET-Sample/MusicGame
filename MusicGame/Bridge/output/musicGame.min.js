"use strict";Bridge.define("MusicGame.App",{statics:{note:0,maxNote:3,noteName:null,blocking:!1,numRight:0,numWrong:0,gameData:null,coinsFlag:!1,coinsAmount:0,clef:"treble",config:{init:function(){this.minNote=-8;this.noteNamesDor=["Do","Re","Mi","Fa","So","La","Ti"];this.noteNamesLetter=["C","D","E","F","G","A","B"];this.audio=Bridge.Array.init(7,null);this.staveImg=new Image;this.noteImg=new Image;this.lineImg=new Image;Bridge.ready(this.main)}},getnoteNames:function(){switch(Bridge.cast(document.getElementsByName("buttonType")[0],HTMLSelectElement).value){case"letter":return MusicGame.App.noteNamesLetter;case"dor":return MusicGame.App.noteNamesDor}throw new Bridge.ArgumentException("Problem");},main:function(){MusicGame.App.updateButtons();Bridge.global.setInterval(MusicGame.App.showCoinsInterval,1e3);for(var n=0;n<7;n++)MusicGame.App.audio[n]=new Audio("Sounds/"+MusicGame.App.noteNamesLetter[n]+".mp3");MusicGame.App.staveImg.src="stave.png";MusicGame.App.noteImg.src="note.png";MusicGame.App.lineImg.src="line.png";MusicGame.App.noteName="do";MusicGame.App.numRight--;MusicGame.App.chooseNote("do",0,!1,!1)},mod:function(n,t){return(n%t+t)%t},httpGet:function(n){var t=new XMLHttpRequest;return t.open("GET",n,!1),t.send(null),t.responseText},addCoinsFunction:function(n){var t=n+MusicGame.App.coinsAmount;MusicGame.App.httpGet("coinChange.php?amount="+t+"&user="+MusicGame.App.gameData.account+"&password="+MusicGame.App.gameData.password);document.getElementById("coinNumber").innerHTML=t.toString();MusicGame.App.coinsChanged(t.toString())},showCoinsInterval:function(){var n=document.getElementById("username").value,t=document.getElementById("password").value;MusicGame.App.gameData=new MusicGame.GameData(n,t);MusicGame.App.coinsFlag&&(MusicGame.App.showCoins(),MusicGame.App.coinsFlag=!1)},coinsChanged:function(n){MusicGame.App.coinsAmount=Bridge.Int.parseInt(n,-2147483648,2147483647)},showCoins:function(){var t="coinRead.php?user="+document.getElementById("username").value+"&password="+document.getElementById("password").value,n=MusicGame.App.httpGet(t);n!=="no READ"&&n!=="no PASSWORD"&&(document.getElementById("coinNumber").innerHTML=n,MusicGame.App.coinsChanged(n))},getNoteName:function(n){switch(MusicGame.App.clef){case"treble":return MusicGame.App.getnoteNames()[MusicGame.App.mod(n-2,MusicGame.App.getnoteNames().length)];case"bass":return MusicGame.App.getnoteNames()[MusicGame.App.mod(n,MusicGame.App.getnoteNames().length)];case"tenor":return MusicGame.App.getnoteNames()[MusicGame.App.mod(n-3,MusicGame.App.getnoteNames().length)];default:throw new Bridge.ArgumentException("Invalid Clef");}},chooseNote:function(n,t,i,r){var u,f,e;(t===void 0&&(t=2e3),i===void 0&&(i=!0),r===void 0&&(r=!0),MusicGame.App.blocking)||(MusicGame.App.blocking=!0,u=n===MusicGame.App.noteName,f=document.getElementById("challenge"),u?(f.innerHTML="Correct!",++MusicGame.App.numRight):(f.innerHTML="Wrong! It's "+MusicGame.App.noteName,++MusicGame.App.numWrong),i&&MusicGame.App.audio[MusicGame.App.mod(MusicGame.App.note,MusicGame.App.getnoteNames().length)].play(),e=document.getElementById("score"),e.innerHTML="Right: "+MusicGame.App.numRight+" Wrong: "+MusicGame.App.numWrong,Bridge.global.setTimeout(MusicGame.App.displayRandomNote,t),r&&u&&MusicGame.App.addCoinsFunction(1))},updateButtons:function(){MusicGame.App.noteName=MusicGame.App.getNoteName(MusicGame.App.note);for(var n=0;n<7;n++)(function(){var t=document.getElementById("b"+n),i=MusicGame.App.getnoteNames()[MusicGame.App.mod(n,MusicGame.App.getnoteNames().length)];t.innerHTML=i;t.onclick=function(){MusicGame.App.chooseNote(i)}}).call(this)},drawNote:function(){var u=document.getElementById("canvas"),n,t,i,r;if(u!==undefined){for(n=u.getContext("2d"),n.fillStyle="rgb(255,255,255)",n.fillRect(0,0,164,164),n.drawImage(MusicGame.App.staveImg,50,50),t=20-MusicGame.App.note*5,n.drawImage(MusicGame.App.noteImg,50,t),i=20;i>=t;i-=10)n.drawImage(MusicGame.App.lineImg,50,i);for(r=80;r<=t;r+=10)n.drawImage(MusicGame.App.lineImg,50,r)}},updateClef:function(){MusicGame.App.clef=document.getElementsByName("clef")[0].value;MusicGame.App.displayRandomNote()},displayRandomNote:function(){var n,t;for(MusicGame.App.blocking=!1,n=document.getElementById("challenge"),n.innerHTML="What is this note?",t=MusicGame.App.note;t===MusicGame.App.note;)MusicGame.App.note=Bridge.Int.trunc(Math.random()*11+MusicGame.App.minNote);MusicGame.App.noteName=MusicGame.App.getNoteName(MusicGame.App.note);MusicGame.App.drawNote()}}});Bridge.define("MusicGame.GameData",{account:null,password:null,constructor:function(n,t){this.account=n;this.password=t}});